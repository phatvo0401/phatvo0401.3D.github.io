<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTP | 3D Archive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --miku: #39c5bb; --glass: rgba(255, 255, 255, 0.02); --border: rgba(57, 197, 187, 0.2); }
        body { font-family: 'Lexend', sans-serif; background-color: #050a09; color: #e6f7f6; margin: 0; overflow-x: hidden; }
        .miku-text { color: var(--miku); text-shadow: 0 0 15px rgba(57, 197, 187, 0.4); }
        .viewport-box {
            background: var(--glass); border: 1px solid var(--border); border-radius: 40px; padding: 30px;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }
        .viewport-box:hover { background: rgba(57, 197, 187, 0.08); border-color: var(--miku); transform: translateY(-10px); }
        .sub-viewport {
            width: 100%; aspect-ratio: 1/1; background: #000; border: 1px solid rgba(255,255,255,0.05);
            border-radius: 25px; overflow: hidden; position: relative;
        }
        .archive-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 40px; padding: 40px; width: 100%; max-width: 1400px;
        }
        .btn-back {
            padding: 10px 25px; border: 1px solid var(--border); border-radius: 100px;
            font-size: 10px; font-weight: 900; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s;
        }
        .btn-back:hover { background: var(--miku); color: #000; border-color: var(--miku); }
    </style>
</head>
<body>

    <nav class="fixed w-full z-50 py-6 px-12 flex justify-between items-center bg-[#050a09]/80 backdrop-blur-xl border-b border-white/5">
        <div class="flex items-center tracking-tighter text-xl uppercase font-black miku-text">VTP <span class="font-light text-white/50 text-xs ml-2 tracking-widest">3D Archive</span></div>
        <a href="https://[username].github.io/" class="btn-back">Back to Home</a>
    </nav>

    <header class="pt-48 pb-10 text-center">
        <h1 class="text-6xl md:text-8xl font-black mb-6 uppercase tracking-tighter italic">GALLERY <span class="miku-text">3D</span></h1>
        <p class="text-white/30 tracking-[0.5em] uppercase text-[9px]">Mô phỏng góc nhìn Studio chuẩn xác</p>
    </header>

    <main class="flex justify-center pb-32">
        <div class="archive-grid">
            <div class="viewport-box">
                <div class="sub-viewport" id="m1"></div>
                <div class="mt-8 flex justify-between items-end">
                    <div>
                        <h3 class="font-black text-xl uppercase tracking-tighter miku-text">Con Cụt</h3>
                        <p class="text-[9px] text-white/40 uppercase tracking-widest mt-1">Studio Viewport / STL</p>
                    </div>
                    <div class="text-[8px] font-bold text-white/20 border border-white/10 px-3 py-1 rounded-full italic">VTP 3D</div>
                </div>
            </div>
            <div class="viewport-box">
                <div class="sub-viewport" id="m2"></div>
                <div class="mt-8 flex justify-between items-end">
                    <div><h3 class="font-black text-xl uppercase tracking-tighter miku-text">Con Gót</h3><p class="text-[9px] text-white/40 uppercase tracking-widest mt-1">Studio Viewport / STL</p></div>
                    <div class="text-[8px] font-bold text-white/20 border border-white/10 px-3 py-1 rounded-full italic">VTP 3D</div>
                </div>
            </div>
            <div class="viewport-box">
                <div class="sub-viewport" id="m1"></div>
                <div class="mt-8 flex justify-between items-end">
                    <div>
                        <h3 class="font-black text-xl uppercase tracking-tighter miku-text">Project 03</h3>
                        <p class="text-[9px] text-white/40 uppercase tracking-widest mt-1">Studio Viewport / STL</p>
                    </div>
                    <div class="text-[8px] font-bold text-white/20 border border-white/10 px-3 py-1 rounded-full italic">VTP 3D</div>
                </div>
            </div>
            <div class="viewport-box">
                <div class="sub-viewport" id="m1"></div>
                <div class="mt-8 flex justify-between items-end">
                    <div>
                        <h3 class="font-black text-xl uppercase tracking-tighter miku-text">Project 01</h3>
                        <p class="text-[9px] text-white/40 uppercase tracking-widest mt-1">Studio Viewport / STL</p>
                    </div>
                    <div class="text-[8px] font-bold text-white/20 border border-white/10 px-3 py-1 rounded-full italic">VTP 3D</div>
                </div>
            </div>
        </div>
    </main>

    <script type="importmap">{ "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }</script>
    
    <script type="module">
        import * as THREE from 'three';
        import { STLLoader } from 'three/addons/loaders/STLLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        function init3D(id, path) {
            const container = document.getElementById(id);
            const scene = new THREE.Scene();
            
            // 1. Camera cố định góc nhìn 30 độ từ trên xuống
            const camera = new THREE.PerspectiveCamera(40, 1, 0.1, 1000);
            camera.position.set(0, 45, 80); 

            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            container.appendChild(renderer.domElement);

            // 2. Cấu hình Grid hình tròn dưới chân
            const circleGrid = new THREE.PolarGridHelper(35, 16, 8, 64, 0x39c5bb, 0x111111);
            circleGrid.position.y = -20; 
            circleGrid.material.opacity = 0.2;
            circleGrid.material.transparent = true;
            scene.add(circleGrid);

            // Ánh sáng
            scene.add(new THREE.AmbientLight(0xffffff, 0.5));
            const sun = new THREE.DirectionalLight(0x39c5bb, 2);
            sun.position.set(20, 50, 20);
            scene.add(sun);

            // 3. Cấu hình OrbitControls: Khóa trục dọc, giới hạn zoom
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            
            // Khóa góc nhìn 30 độ (không cho lật lên xuống)
            const polarAngle = Math.PI / 3; 
            controls.minPolarAngle = polarAngle;
            controls.maxPolarAngle = polarAngle;
            
            // Giới hạn thu phóng
            controls.minDistance = 60; 
            controls.maxDistance = 120;

            const loader = new STLLoader();
            loader.load(path, (geometry) => {
                // 4. Căn giữa model tuyệt đối
                geometry.computeBoundingBox();
                const center = new THREE.Vector3();
                geometry.boundingBox.getCenter(center);
                geometry.translate(-center.x, -center.y, -center.z);

                const material = new THREE.MeshPhongMaterial({ 
                    color: 0x39c5bb, specular: 0x111111, shininess: 80, transparent: true, opacity: 0.95 
                });
                const mesh = new THREE.Mesh(geometry, material);
                
                // 5. FIX LỖI BỊ NGÃ: Xoay -90 độ trục X để model đứng thẳng
                mesh.rotation.x = -Math.PI / 2;

                // Quy mô model tự động theo khung
                const size = new THREE.Vector3();
                geometry.boundingBox.getSize(size);
                const scale = 45 / Math.max(size.x, size.y, size.z);
                mesh.scale.set(scale, scale, scale);
                
                scene.add(mesh);

                function animate() {
                    requestAnimationFrame(animate);
                    // 6. Xoay tự động quanh trục dọc
                    mesh.rotation.z += 0.005; 
                    controls.update();
                    renderer.render(scene, camera);
                }
                animate();
            });
        }

        init3D('m1', 'model.stl');
        init3D('m2', 'model2.stl');
    </script>
</body>
</html>


